# Model
model:
  rest_name: servicetoken
  resource_name: servicetoken
  entity_name: ServiceToken
  package: cactuar
  group: policy/token
  description: |-
    This API issues a new service token using the namespace certificate that can be
    used by third party applications.

# Attributes
attributes:
  v1:
  - name: audience
    description: |-
      If given, the issued token will only be valid for the audience provided. If
      empty, the audience will be resolved from the policies. If no audience can be
      resolved, the request will be rejected with an error.
    type: string
    exposed: true
    validations:
    - $audience

  - name: objectID
    description: ID of the object you want to issue a token for.
    type: string
    exposed: true
    example_value: 5c83035648675400019ab901

  - name: sessionID
    description: Provides the session ID of the defender when retrieving a datapath
      certificate.
    type: string
    exposed: true
    example_value: 5c83035648675400019ab901

  - name: token
    description: Token is the signed JWT service token.
    type: string
    exposed: true
    read_only: true
    autogenerated: true

  - name: type
    description: Type of token request.
    type: enum
    exposed: true
    allowed_choices:
    - ProcessingUnit
    - Service
    default_value: Service

  - name: validity
    description: |-
      Validity configures the max validity time for a token. If it is bigger than the
      configured max validity, it will be capped.
    type: string
    exposed: true
    default_value: 15m
    orderable: true
    validations:
    - $timeDuration
